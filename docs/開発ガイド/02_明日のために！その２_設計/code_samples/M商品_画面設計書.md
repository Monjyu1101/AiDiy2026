# M商品 画面設計書

**作成日**: 2026-02-15
**対象画面**: M商品一覧、M商品編集
**バージョン**: 1.0

---

## 1. 画面一覧

| 画面名 | URL | 概要 |
|--------|-----|------|
| M商品一覧 | /Mマスタ/M商品/ | 商品一覧の表示・検索 |
| M商品編集 | /Mマスタ/M商品/編集 | 商品の新規登録・更新 |

---

## 2. M商品一覧画面

### 2.1 画面概要

商品マスタの一覧を表示し、検索・新規登録・更新・削除を行う画面。

### 2.2 画面レイアウト

```
┌──────────────────────────────────────────────────────────┐
│ M商品一覧 │
├──────────────────────────────────────────────────────────┤
│ [再検索] [新規] │
├──────────────────────────────────────────────────────────┤
│ □ 商品ID │ 商品名 │ 単位 │ 商品備考 │ 更新日時 │ 更新利用者名 │ [編集] [削除] │
│ ─────────┼────────────┼──────┼───────────┼──────────────┼─────────────┼──────────────┤
│ □ ITEM001 │ テスト商品A │ 個 │ サンプル │ 2026-02-15... │ admin │ [編集] [削除] │
│ □ ITEM002 │ テスト商品B │ 箱 │ 10個入り │ 2026-02-15... │ user01 │ [編集] [削除] │
│ □ ITEM003 │ テスト商品C │ kg │ 重量商品 │ 2026-02-15... │ admin │ [編集] [削除] │
└──────────────────────────────────────────────────────────┘
```

### 2.3 画面項目

#### ツールバー

| 項目名 | 種類 | 機能 |
|--------|------|------|
| 再検索ボタン | Button | 一覧を再取得する |
| 新規ボタン | Button | 新規登録画面へ遷移 |

#### データテーブル

| カラム名 | データ型 | ソート | フィルタ | 説明 |
|----------|----------|--------|----------|------|
| チェックボックス | Checkbox | - | - | 行選択用 |
| 商品ID | Text | ○ | ○ | 商品を識別するID |
| 商品名 | Text | ○ | ○ | 商品の名称 |
| 単位 | Text | ○ | ○ | 商品の単位 |
| 商品備考 | Text | - | ○ | 備考情報 |
| 更新日時 | DateTime | ○ | - | 最終更新日時 |
| 更新利用者名 | Text | ○ | - | 最終更新者 |
| 編集ボタン | Button | - | - | 編集画面へ遷移 |
| 削除ボタン | Button | - | - | 削除確認後、データを削除 |

### 2.4 画面操作

#### 初期表示

1. `/apps/V商品/一覧` APIを呼び出し
2. 取得したデータをテーブルに表示
3. 商品ID順でソート

#### 再検索ボタン押下

1. 現在のフィルタ・ソート条件を保持
2. `/apps/V商品/一覧` APIを再呼び出し
3. テーブルをリフレッシュ

#### 新規ボタン押下

1. `/Mマスタ/M商品/編集?mode=create` へ遷移

#### 編集ボタン押下

1. 選択行の商品IDを取得
2. `/Mマスタ/M商品/編集?mode=update&id={商品ID}` へ遷移

#### 削除ボタン押下

1. 削除確認ダイアログを表示
 - メッセージ: 「この商品を削除してもよろしいですか？」
2. OKの場合:
 - `/apps/M商品/削除` APIを呼び出し
 - 成功メッセージを表示
 - 一覧を再取得
3. キャンセルの場合:
 - 何もしない

### 2.5 エラー処理

| エラーケース | メッセージ | 処理 |
|--------------|------------|------|
| API呼び出し失敗 | 「データの取得に失敗しました」 | エラーメッセージを画面上部に表示 |
| 削除失敗 | APIのエラーメッセージを表示 | エラーメッセージを画面上部に表示 |

---

## 3. M商品編集画面

### 3.1 画面概要

商品マスタの新規登録・更新を行う画面。

### 3.2 画面レイアウト

#### 新規登録モード

```
┌──────────────────────────────────────────────────────────┐
│ M商品編集（新規登録） │
├──────────────────────────────────────────────────────────┤
│ 商品ID * [ ITEM004 ] │
│ 商品名 * [ 新しい商品 ] │
│ 単位 * [ 個 ] │
│ 商品備考 [ ] │
│ [ ] │
│ │
│ [キャンセル] [登録] │
└──────────────────────────────────────────────────────────┘
```

#### 更新モード

```
┌──────────────────────────────────────────────────────────┐
│ M商品編集（更新） │
├──────────────────────────────────────────────────────────┤
│ 商品ID ITEM001 （変更不可） │
│ 商品名 * [ テスト商品A ] │
│ 単位 * [ 個 ] │
│ 商品備考 [ サンプルデータです ] │
│ [ ] │
│ │
│ 登録日時: 2026-02-10 09:00:00 登録者: admin │
│ 更新日時: 2026-02-15 10:30:00 更新者: admin │
│ │
│ [キャンセル] [変更] │
└──────────────────────────────────────────────────────────┘
```

### 3.3 画面項目

#### 入力フィールド

| 項目名 | 種類 | 必須 | 最大長 | 新規 | 更新 | 説明 |
|--------|------|------|--------|------|------|------|
| 商品ID | Text | ○ | 50 | 入力可 | 表示のみ | 商品を識別するID |
| 商品名 | Text | ○ | 200 | 入力可 | 入力可 | 商品の名称 |
| 単位 | Text | ○ | 50 | 入力可 | 入力可 | 商品の単位 |
| 商品備考 | TextArea | - | 500 | 入力可 | 入力可 | 備考情報 |

#### 監査情報（更新モードのみ表示）

| 項目名 | 種類 | 説明 |
|--------|------|------|
| 登録日時 | Label | データ登録日時 |
| 登録者 | Label | データ登録者名 |
| 更新日時 | Label | データ最終更新日時 |
| 更新者 | Label | データ最終更新者名 |

#### ボタン

| ボタン名 | 機能 |
|----------|------|
| キャンセル | 一覧画面へ戻る（変更を破棄） |
| 登録 | 新規登録処理を実行（新規モード） |
| 変更 | 更新処理を実行（更新モード） |

### 3.4 バリデーション

#### 必須チェック

| 項目 | エラーメッセージ |
|------|------------------|
| 商品ID | 「商品IDを入力してください」 |
| 商品名 | 「商品名を入力してください」 |
| 単位 | 「単位を入力してください」 |

#### 文字数チェック

| 項目 | エラーメッセージ |
|------|------------------|
| 商品ID | 「商品IDは50文字以内で入力してください」 |
| 商品名 | 「商品名は200文字以内で入力してください」 |
| 単位 | 「単位は50文字以内で入力してください」 |
| 商品備考 | 「商品備考は500文字以内で入力してください」 |

#### 重複チェック（新規登録のみ）

| 項目 | エラーメッセージ |
|------|------------------|
| 商品ID | 「この商品IDは既に登録されています」 |

### 3.5 画面操作

#### 新規登録モード

**初期表示**

1. URLパラメータ `mode=create` を確認
2. 全フィールドを空にする
3. 商品IDフィールドにフォーカス

**登録ボタン押下**

1. クライアント側バリデーション実行
2. エラーがあれば、該当フィールドにエラーメッセージ表示
3. エラーがなければ `/apps/M商品/登録` APIを呼び出し
4. 成功時:
 - 成功メッセージを表示
 - 一覧画面へ遷移
5. 失敗時:
 - APIのエラーメッセージを表示

#### 更新モード

**初期表示**

1. URLパラメータ `mode=update&id={商品ID}` を確認
2. `/apps/M商品/取得` APIを呼び出し
3. 取得したデータをフィールドに設定
4. 商品IDフィールドを読み取り専用にする
5. 監査情報を表示

**変更ボタン押下**

1. クライアント側バリデーション実行
2. エラーがあれば、該当フィールドにエラーメッセージ表示
3. エラーがなければ `/apps/M商品/変更` APIを呼び出し
4. 成功時:
 - 成功メッセージを表示
 - 一覧画面へ遷移
5. 失敗時:
 - APIのエラーメッセージを表示

**キャンセルボタン押下**

1. 確認なしで一覧画面へ遷移

### 3.6 エラー処理

| エラーケース | メッセージ | 処理 |
|--------------|------------|------|
| バリデーションエラー | 項目別のエラーメッセージ | 該当フィールドの下にエラー表示 |
| 商品ID重複 | 「この商品IDは既に登録されています」 | 商品IDフィールドにエラー表示 |
| データ未検出 | 「指定された商品が見つかりません」 | エラーメッセージを表示後、一覧へ戻る |
| API呼び出し失敗 | APIのエラーメッセージ | エラーメッセージを画面上部に表示 |

---

## 4. 画面遷移図

```
┌─────────────────┐
│ M商品一覧 │
│ /Mマスタ/M商品/ │
└─────────────────┘
 │
 │ [新規]ボタン
 ↓
┌─────────────────────────────────┐
│ M商品編集（新規登録） │
│ /Mマスタ/M商品/編集?mode=create │
└─────────────────────────────────┘
 │
 │ [登録]ボタン → 成功
 ↓
┌─────────────────┐
│ M商品一覧 │ ← 成功メッセージ表示
└─────────────────┘

┌─────────────────┐
│ M商品一覧 │
└─────────────────┘
 │
 │ [編集]ボタン
 ↓
┌──────────────────────────────────────┐
│ M商品編集（更新） │
│ /Mマスタ/M商品/編集?mode=update&id=xxx │
└──────────────────────────────────────┘
 │
 │ [変更]ボタン → 成功
 ↓
┌─────────────────┐
│ M商品一覧 │ ← 成功メッセージ表示
└─────────────────┘
```

---

## 5. UI/UX設計

### 5.1 デザイン方針

- **シンプル**: 必要最小限の項目のみ表示
- **直感的**: ボタン配置は一般的な位置（右下）
- **レスポンシブ**: 画面幅に応じてレイアウト調整

### 5.2 カラー設計

| 要素 | 色 | 用途 |
|------|-----|------|
| 主要ボタン | 青系 | 登録・変更など主要アクション |
| 削除ボタン | 赤系 | 削除など破壊的アクション |
| エラーメッセージ | 赤系 | バリデーションエラー |
| 成功メッセージ | 緑系 | 処理成功通知 |

### 5.3 アクセシビリティ

- フォーカス順序: タブキーで上から下へ自然に移動
- エラー表示: スクリーンリーダーに対応したaria属性を付与
- キーボード操作: マウスなしでも操作可能

---

## 6. 非機能要件

### 6.1 パフォーマンス

- 一覧取得: 10,000件以下は3秒以内に表示
- 登録・更新: 1秒以内に完了

### 6.2 セキュリティ

- JWT認証必須
- XSS対策: 入力値はすべてエスケープ
- CSRF対策: Axiosの自動対応

---

## 変更履歴

| 日付 | バージョン | 変更者 | 変更内容 |
|------|------------|--------|----------|
| 2026-02-15 | 1.0 | admin | 初版作成 |
